<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vocabulary Questï½œLevel Aï¼ˆ20 Wordsï¼‰</title>
  <style>
    :root{
      --bg:#f4f8ff;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --primary:#2563eb;
      --primary2:#1d4ed8;
      --good:#16a34a;
      --bad:#dc2626;
      --border:#dbeafe;
      --shadow:0 10px 30px rgba(15,23,42,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", Arial, sans-serif;
      background: radial-gradient(1200px 600px at 20% 0%, #e0f2fe 0%, var(--bg) 55%, #eef2ff 100%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .wrap{
      width:min(820px, 100%);
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      box-shadow:var(--shadow);
      padding:20px;
    }
    h1{
      margin:4px 0 14px;
      font-size:clamp(20px, 3vw, 28px);
      letter-spacing:.2px;
    }
    .sub{
      margin:0 0 14px;
      color:var(--muted);
      line-height:1.5;
      font-size:14px;
    }
    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin:10px 0 14px;
    }
    button{
      border:none;
      border-radius:14px;
      padding:14px 18px;
      font-size:18px;
      font-weight:750;
      cursor:pointer;
      transition:.15s transform, .15s box-shadow, .15s background;
      box-shadow:0 10px 18px rgba(37,99,235,.18);
    }
    button:active{ transform: translateY(1px); }
    #startBtn{
      background:linear-gradient(180deg, var(--primary) 0%, var(--primary2) 100%);
      color:#fff;
      box-shadow:0 12px 22px rgba(37,99,235,.30);
    }
    #nextBtn{
      background:#0ea5e9;
      color:#fff;
      box-shadow:0 12px 22px rgba(14,165,233,.28);
    }
    #game{
      margin-top:6px;
      padding:14px;
      border-radius:16px;
      background: linear-gradient(180deg, #f8fbff 0%, #ffffff 70%);
      border:1px solid #e0f2fe;
    }
    #word{
      margin:4px 0 8px;
      font-size:34px;
      letter-spacing:.5px;
    }
    #definition{
      margin:0 0 12px;
      color:var(--muted);
      font-size:16px;
      line-height:1.5;
      background:#f1f5ff;
      border:1px dashed #c7d2fe;
      border-radius:12px;
      padding:10px 12px;
    }
    #choices{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
      margin:10px 0 12px;
    }
    .choice{
      width:100%;
      text-align:left;
      background:#ffffff;
      color:var(--text);
      border:2px solid #dbeafe;
      box-shadow:0 10px 18px rgba(15,23,42,.06);
    }
    .choice:hover{ border-color:#93c5fd; }
    .choice.correct{
      border-color:#86efac;
      box-shadow:0 12px 24px rgba(22,163,74,.18);
    }
    .choice.wrong{
      border-color:#fecaca;
      box-shadow:0 12px 24px rgba(220,38,38,.14);
    }
    .choice:disabled{
      opacity:.92;
      cursor:not-allowed;
    }
    #feedback{
      margin:12px 0 12px;
      font-size:16px;
      line-height:1.6;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid #e2e8f0;
      background:#ffffff;
      min-height:54px;
    }
    .bottom{
      display:flex;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
      justify-content:space-between;
      margin-top:10px;
    }
    .progressWrap{
      display:flex;
      align-items:center;
      gap:10px;
      color:var(--muted);
      font-weight:650;
    }
    progress{
      width:min(360px, 70vw);
      height:18px;
      border-radius:999px;
      overflow:hidden;
    }
    progress::-webkit-progress-bar{
      background:#e2e8f0;
      border-radius:999px;
    }
    progress::-webkit-progress-value{
      background:linear-gradient(90deg, #facc15, #fb7185);
      border-radius:999px;
    }
    .hint{
      color:var(--muted);
      font-size:13px;
      margin-top:10px;
      line-height:1.5;
    }
    @media (min-width:720px){
      #choices{ grid-template-columns:1fr 1fr; }
      .choice{ min-height:64px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Vocabulary Questï½œLevel Aï¼ˆ20 Wordsï¼‰</h1>
    <p class="sub">è¦å‰‡ï¼šæ¯é¡Œä¸‰é¸ä¸€ã€‚ç­”é¡Œå‰ä¸æ´©æ¼ç­”æ¡ˆï¼›ç­”éŒ¯æ‰æœƒé¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆï¼‹ä¸­æ–‡è§£æã€‚éŒ¯é¡Œæœ¬é‡ç·´ï¼šå¿…é ˆå…¨å°æ‰ç®—é€šé—œï¼ˆç­”éŒ¯æœƒä¸Ÿåˆ°éšŠå°¾ï¼‰ã€‚</p>

    <div class="controls">
      <button id="startBtn">é–‹å§‹é—–é—œ</button>
    </div>

    <div id="game" style="display:none;">
      <h2 id="word"></h2>
      <p id="definition"></p>
      <div id="choices"></div>
      <p id="feedback"></p>

      <div class="bottom">
        <button id="nextBtn" style="display:none;">ä¸‹ä¸€é¡Œ</button>
        <div class="progressWrap">
          é€²åº¦ï¼š
          <progress id="progress" value="0" max="20"></progress>
        </div>
      </div>

      <div class="hint">å°æŠ€å·§ï¼šå…ˆæ’é™¤ã€Œæ˜é¡¯ä¸åˆç†ã€çš„é¸é …ï¼Œå†å›é ­æ¯”å°èªæ„æœ€ç²¾æº–çš„ä¸€å€‹ã€‚</div>
    </div>
  </div>

  
  document.addEventListener("DOMContentLoaded", function () {
    // ====== DATA ======
    var words = [
      { word: "ability", def: "the power or skill to do something", zhExplain: "abilityï¼èƒ½åŠ›ã€‚å¸¸ç”¨ï¼šhave the ability to + Vï¼ˆæœ‰èƒ½åŠ›åšâ€¦ï¼‰ã€‚", confusable: "skill" },
      { word: "able", def: "having the skill to do something", zhExplain: "be able to + Vï¼èƒ½å¤ åšâ€¦ã€‚capable ä¹Ÿåƒä½†è¼ƒæ­£å¼ã€‚", confusable: "capable" },
      { word: "about", def: "related to; concerning", zhExplain: "aboutï¼é—œæ–¼ã€‚ä¾‹ï¼štalk about / learn aboutã€‚", confusable: "concerning" },
      { word: "above", def: "at a higher position", zhExplain: "aboveï¼åœ¨â€¦ä¸Šæ–¹ï¼ˆä½ç½®ï¼‰ã€‚over æœ‰æ™‚ä¹Ÿå¯ï¼Œä½†å¸¸å«è¦†è“‹æ„Ÿã€‚", confusable: "over" },
      { word: "across", def: "from one side to the other", zhExplain: "acrossï¼åˆ°å°é¢ï¼›throughï¼ç©¿éå…§éƒ¨ã€‚", confusable: "through" },
      { word: "act", def: "to do something; behave", zhExplain: "actï¼è¡Œå‹•/è¡¨ç¾ã€‚ä¾‹ï¼šact politelyï¼ˆè¡¨ç¾å¾—æœ‰ç¦®ï¼‰ã€‚", confusable: "behave" },
      { word: "action", def: "something that is done", zhExplain: "actionï¼åšå‡ºä¾†çš„è¡Œå‹•ï¼›behaviorï¼è¡Œç‚ºè¡¨ç¾ï¼ˆè¼ƒæŠ½è±¡ï¼‰ã€‚", confusable: "behavior" },
      { word: "add", def: "to put something more", zhExplain: "addï¼åŠ ä¸Šã€‚åç¾©ï¼šremove / reduceã€‚", confusable: "increase" },
      { word: "afraid", def: "feeling fear", zhExplain: "be afraid of + N/Vingï¼å®³æ€•â€¦ï¼›be afraid to + Vï¼ä¸æ•¢â€¦ã€‚", confusable: "scared" },
      { word: "after", def: "later than something", zhExplain: "afterï¼åœ¨â€¦ä¹‹å¾Œï¼›beforeï¼åœ¨â€¦ä¹‹å‰ã€‚", confusable: "before" },

      { word: "agree", def: "to have the same opinion", zhExplain: "agreeï¼åŒæ„ï¼ˆçœ‹æ³•ä¸€è‡´ï¼‰ã€‚agree with + äºº/æ„è¦‹ã€‚", confusable: "accept" },
      { word: "allow", def: "to let someone do something", zhExplain: "allowï¼å…è¨±ï¼ˆè¼ƒæ­£å¼ï¼‰ã€‚allow sb to + Vã€‚", confusable: "let" },
      { word: "almost", def: "nearly; not completely", zhExplain: "almostï¼å¹¾ä¹/å·®ä¸€é»ã€‚ä¾‹ï¼šalmost finishedã€‚", confusable: "nearly" },
      { word: "already", def: "before now", zhExplain: "alreadyï¼å·²ç¶“ï¼ˆè‚¯å®šå¥å¸¸ç”¨ï¼‰ã€‚yetï¼é‚„æ²’ï¼ˆç–‘å•/å¦å®šå¸¸ç”¨ï¼‰ã€‚", confusable: "yet" },
      { word: "always", def: "at all times", zhExplain: "alwaysï¼ç¸½æ˜¯ï¼ˆ100%ï¼‰ï¼›usuallyï¼é€šå¸¸ï¼ˆå¤šæ•¸æƒ…æ³ï¼‰ã€‚", confusable: "usually" },
      { word: "angry", def: "feeling mad", zhExplain: "angryï¼ç”Ÿæ°£ã€‚angry at/with sbï¼ˆå°æŸäººç”Ÿæ°£ï¼‰ã€‚", confusable: "mad" },
      { word: "answer", def: "a reply to a question", zhExplain: "answerï¼å›ç­”å•é¡Œï¼›replyï¼å›è¦†è¨Šæ¯/äººã€‚", confusable: "reply" },
      { word: "appear", def: "to show up", zhExplain: "appearï¼å‡ºç¾ã€‚ä¾‹ï¼šA message appeared on the screenã€‚", confusable: "show up" },
      { word: "area", def: "a place or region", zhExplain: "areaï¼å€åŸŸ/ç¯„åœï¼›regionï¼åœ°å€ï¼ˆæ›´å¤§æ›´æ­£å¼ï¼‰ã€‚", confusable: "region" },
      { word: "arrive", def: "to get to a place", zhExplain: "arrive at/inï¼åˆ°é”ï¼›reachï¼‹åœ°é»ï¼ˆç›´æ¥å—è©ï¼‰ã€‚", confusable: "reach" }
    ];

    var STAGE_SIZE = 10;
    var REVIEW_LIMIT = 5;

    // ====== GET ELEMENTS ======
    var startBtn = document.getElementById("startBtn");
    var game = document.getElementById("game");
    var wordEl = document.getElementById("word");
    var defEl = document.getElementById("definition");
    var choicesEl = document.getElementById("choices");
    var feedback = document.getElementById("feedback");
    var nextBtn = document.getElementById("nextBtn");
    var progressBar = document.getElementById("progress");

    // ====== CHECK REQUIRED ======
    var missing = [];
    if (!startBtn) missing.push("startBtn");
    if (!game) missing.push("game");
    if (!wordEl) missing.push("word");
    if (!defEl) missing.push("definition");
    if (!choicesEl) missing.push("choices");
    if (!feedback) missing.push("feedback");
    if (!nextBtn) missing.push("nextBtn");

    if (missing.length > 0) {
      document.body.innerHTML =
        '<div style="padding:16px;font-family:system-ui;">' +
        '<h2 style="color:#b00020;">æ‰¾ä¸åˆ°å¿…è¦çš„ HTML id</h2>' +
        "<p>è«‹ç¢ºèª HTML è£¡æœ‰é€™äº› idï¼š<b>" + missing.join(", ") + "</b></p>" +
        "</div>";
      return;
    }

    // ====== STATE ======
    var stage = 1;
    var index = 0;
    var locked = false;

    // main éŒ¯é¡Œç´€éŒ„ï¼ˆç”¨ä¾†æŒ‘ review é¡Œï¼‰
    var wrongSet = {};

    // æ¨¡å¼ï¼šmain / review
    var mode = "main";

    // review é¡Œç›®éšŠåˆ—ï¼ˆæ”¾ words çš„ indexï¼‰
    var reviewQueue = [];
    var reviewPos = 0;

    // ç”¨ä¾†åˆ¤æ–·ã€Œæ˜¯å¦å·²ç¶“ä¸€è¼ªéƒ½ç­”å°ã€
    var reviewAddedThisRound = false;

    // ====== STAGE TITLE ======
    var stageTitle = document.createElement("div");
    stageTitle.style.margin = "10px 0";
    stageTitle.style.fontWeight = "800";
    stageTitle.style.color = "#2f6fed";
    wordEl.parentNode.insertBefore(stageTitle, wordEl);

    // ====== START ======
    startBtn.onclick = function () {
      startBtn.style.display = "none";
      game.style.display = "block";

      // reset
      stage = 1;
      index = 0;
      locked = false;
      wrongSet = {};
      mode = "main";
      reviewQueue = [];
      reviewPos = 0;
      reviewAddedThisRound = false;

      render();
    };

    // ====== RENDER ======
    function render() {
      locked = false;
      feedback.innerHTML = "";
      nextBtn.style.display = "none";
      choicesEl.innerHTML = "";

      if (mode === "review") {
        // progress for review
        if (progressBar) {
          progressBar.max = reviewQueue.length;
          progressBar.value = reviewPos;
        }

        // âœ… å®Œæˆæ¢ä»¶ï¼šèµ°åˆ°éšŠå°¾ï¼Œä¸”é€™ä¸€è¼ªæ²’æœ‰æ–°å¢ã€Œè¢«ä¸Ÿåˆ°éšŠå°¾ã€çš„é¡Œ
        if (reviewPos >= reviewQueue.length) {
          if (reviewAddedThisRound) {
            reviewPos = 0;
            reviewAddedThisRound = false;
          } else {
            stageTitle.textContent = "";
            wordEl.textContent = "ğŸ éŒ¯é¡Œæœ¬é€šé—œï¼";
            defEl.textContent = "å¤ªæ£’äº†ï¼ä½ å·²æŠŠéŒ¯é¡Œæœ¬å…¨éƒ¨ç­”å°ï¼Œæ­£å¼é€šé—œã€‚";
            return;
          }
        }

        var wIndex = reviewQueue[reviewPos];
        var currentR = words[wIndex];

        stageTitle.textContent = "éŒ¯é¡Œæœ¬é‡ç·´ï¼ˆå¿…é ˆå…¨å°ï¼‰ " + (reviewPos + 1) + "/" + reviewQueue.length;
        wordEl.textContent = currentR.word;

        defEl.textContent = "æç¤ºï¼šå…ˆæ’é™¤æ˜é¡¯ä¸åˆç†çš„é¸é …ã€‚";

        var optionsR = buildOptions(currentR.def);
        for (var i = 0; i < optionsR.length; i++) {
          (function (opt) {
            var btn = document.createElement("button");
            btn.textContent = opt;
            btn.className = "choice";
            btn.onclick = function () {
              checkAnswer(opt, currentR.def, btn, wIndex);
            };
            choicesEl.appendChild(btn);
          })(optionsR[i]);
        }

        nextBtn.textContent = "ä¸‹ä¸€é¡Œ";
        return;
      }

      // ====== MAIN MODE ======
      if (progressBar) {
        progressBar.max = words.length;
        progressBar.value = index;
      }

      var start = (stage - 1) * STAGE_SIZE;
      var end = start + STAGE_SIZE;

      // å…¨éƒ¨åšå®Œ â†’ é€²éŒ¯é¡Œæœ¬
      if (index >= words.length) {
        prepareReview();
        return;
      }

      // æ¯é—œå®Œæˆç•«é¢
      if (index >= end) {
        stageTitle.textContent = "ç¬¬ " + stage + " é—œï¼ˆå®Œæˆï¼‰";
        wordEl.textContent = "âœ… ç¬¬ " + stage + " é—œå®Œæˆï¼";
        defEl.textContent = "æŒ‰ã€Œä¸‹ä¸€é¡Œã€é€²å…¥ä¸‹ä¸€é—œã€‚";
        nextBtn.textContent = "ä¸‹ä¸€é—œ";
        nextBtn.style.display = "inline-block";
        return;
      }

      // æ­£å¸¸é¡Œ
      var withinStage = (index - start) + 1;
      stageTitle.textContent = "ç¬¬ " + stage + " é—œï¼ˆ" + withinStage + "/10ï¼‰";

      var current = words[index];
      wordEl.textContent = current.word;
      defEl.textContent = "æç¤ºï¼šå…ˆæ’é™¤æ˜é¡¯ä¸åˆç†çš„é¸é …ã€‚";

      var options = buildOptions(current.def);
      for (var j = 0; j < options.length; j++) {
        (function (opt2) {
          var btn2 = document.createElement("button");
          btn2.textContent = opt2;
          btn2.className = "choice";
          btn2.onclick = function () {
            checkAnswer(opt2, current.def, btn2, index);
          };
          choicesEl.appendChild(btn2);
        })(options[j]);
      }

      nextBtn.textContent = "ä¸‹ä¸€é¡Œ";
    }

    // ====== PREPARE REVIEW ======
    function prepareReview() {
      var wrongList = [];
      for (var key in wrongSet) {
        if (wrongSet.hasOwnProperty(key)) wrongList.push(parseInt(key, 10));
      }

      if (wrongList.length === 0) {
        stageTitle.textContent = "";
        wordEl.textContent = "ğŸ‰ å…¨éƒ¨å®Œæˆï¼";
        defEl.textContent = "å¤ªæ£’äº†ï¼ä½  20 é¡Œå…¨å°ï¼Œæ²’æœ‰éŒ¯é¡Œéœ€è¦é‡ç·´ã€‚";
        return;
      }

      reviewQueue = shuffle(wrongList.slice()).slice(0, REVIEW_LIMIT);
      reviewPos = 0;
      reviewAddedThisRound = false;
      mode = "review";

      stageTitle.textContent = "éŒ¯é¡Œæœ¬æº–å‚™ä¸­â€¦";
      wordEl.textContent = "ğŸ“Œ é€²å…¥éŒ¯é¡Œæœ¬é‡ç·´ï¼ˆå¿…é ˆå…¨å°ï¼‰";
      defEl.textContent = "è¦å‰‡ï¼šç­”éŒ¯çš„é¡Œç›®æœƒè¢«ä¸Ÿåˆ°éšŠå°¾ï¼Œç›´åˆ°ä½ æŠŠæ•´å€‹éŒ¯é¡ŒéšŠä¼å…¨éƒ¨ç­”å°æ‰ç®—é€šé—œã€‚æŒ‰ã€Œä¸‹ä¸€é¡Œã€é–‹å§‹ã€‚";
      nextBtn.textContent = "é–‹å§‹é‡ç·´";
      nextBtn.style.display = "inline-block";
    }

    // ====== OPTIONS ======
    function buildOptions(correctDef) {
      var distractorPool = [
        "a kind of food",
        "a place to sleep",
        "a person who teaches students",
        "a time after dinner",
        "something you wear on your head",
        "a tool used to cut paper"
      ];

      var distractors = shuffle(distractorPool.slice());
      var pick = [];
      for (var i = 0; i < distractors.length && pick.length < 2; i++) {
        if (distractors[i] !== correctDef) pick.push(distractors[i]);
      }

      var all = [correctDef, pick[0], pick[1]];
      return shuffle(all);
    }

    // ====== CHECK ANSWER ======
    function checkAnswer(selected, correct, btn, wIndex) {
      if (locked) return;
      locked = true;

      var current = words[wIndex];

      var btns = choicesEl.querySelectorAll("button");
      for (var i = 0; i < btns.length; i++) {
        btns[i].disabled = true;
      }

      if (selected === correct) {
        btn.classList.add("correct");
        feedback.innerHTML = "âœ… <b>ç­”å°äº†ï¼</b><br>åšå¾—å¥½ï¼ä¸‹ä¸€é¡Œç¹¼çºŒã€‚";
      } else {
        btn.classList.add("wrong");

        // mainï¼šè¨˜éŒ„éŒ¯é¡Œ
        if (mode === "main") {
          if (!wrongSet[wIndex]) wrongSet[wIndex] = true;
        }

        // reviewï¼šç­”éŒ¯ä¸Ÿåˆ°éšŠå°¾ï¼ˆé—œéµï¼‰
        if (mode === "review") {
          reviewQueue.push(wIndex);
          reviewAddedThisRound = true;
        }

        feedback.innerHTML =
          "âŒ <b>ç­”éŒ¯æ²’é—œä¿‚ï¼</b><br>" +
          "âœ… æ­£ç¢ºç­”æ¡ˆï¼ˆè‹±æ–‡è§£é‡‹ï¼‰ï¼š<b>" + correct + "</b><br>" +
          "ä¸­æ–‡è§£æï¼š" + current.zhExplain + "<br>" +
          "æ˜“æ··å­—æé†’ï¼š<b>" + current.confusable + "</b><br>" +
          (mode === "review" ? "<br>ğŸ“Œ é€™é¡Œå·²ä¸Ÿåˆ°éšŠå°¾ï¼Œç¨å¾Œæœƒå†å‡ºç¾ä¸€æ¬¡ã€‚" : "");
      }

      nextBtn.style.display = "inline-block";
      nextBtn.textContent = "ä¸‹ä¸€é¡Œ";
    }

    // ====== NEXT ======
    nextBtn.onclick = function () {
      if (mode === "review") {
        reviewPos = reviewPos + 1;
        render();
        return;
      }

      var start = (stage - 1) * STAGE_SIZE;
      var end = start + STAGE_SIZE;

      if (index >= end) {
        stage = stage + 1;
        render();
        return;
      }

      index = index + 1;
      render();
    };

    // ====== SHUFFLE ======
    function shuffle(arr) {
      for (var i = arr.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
      }
      return arr;
    }
  });

</body>
</html>
